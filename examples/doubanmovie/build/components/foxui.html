<fox-element name=fox-refresher><tpl><div id=fox-refresher-content class=fox-refresher-content><content></content></div></tpl><script>fox("fox-refresher",{lifecycle:{created:function(){},inserted:function(){}},methods:{refreshComplete:function(){$(this).closest("fox-content").get(0)._refreshComplete()},fireRefresh:function(){xtag.fireEvent(this,"refresh",{})},init:function(){var e=$(this).height();$(this).css({top:-e+"px"})}}});</script></fox-element><fox-element name=fox-infinite-scroll attributes=distance><script>fox("fox-infinite-scroll",{lifecycle:{created:function(){this.distance=this.distance||0,this.enable=!0}},methods:{getDistance:function(e){var i=this.distance,t=/(\d+)(%?)/.exec(i);return t&&""!=t[2]?""!=t[2]?e-e*t[1]/100:void 0:e-(parseInt(i)||0)},fireInfinite:function(){this.enable&&(this.enable=!1,xtag.fireEvent(this,"infinite",{}))},infiniteComplete:function(){this.enable=!0}}});</script></fox-element><fox-element name=fox-content><tpl><div id=fox-content-scroller class=fox-content-scroller><content></content></div></tpl><script>function FoxContent(t){this.setupInfiniteScroll=function(e){var s=e.get(0);$(t).bind("scroll",function(){t.scrollTop+$(t).height()>=s.getDistance(t.scrollHeight)&&s.fireInfinite()})},this.setupPulltorefresh=function(e){function s(s,o){var i=s-$(t).scrollTop(),l=0===Math.min(parseInt(i/n),1)?"up":"down";e.get(0).className="fox-refresher-status-"+l,r.style.webkitTransitionDuration=r.style.MozTransitionDuration=r.style.msTransitionDuration=r.style.OTransitionDuration=r.style.transitionDuration=o+"ms",r.style.webkitTransform="translate3d(0,"+s+"px,0)",r.style.msTransform=r.style.MozTransform=r.style.OTransform="translateY("+s+"px)"}var n,o=$(t.$["fox-listview-content"]),i=($(t.$["fox-refresher-content"]),this),r=t.$["fox-content-scroller"];r.addEventListener("webkitTransitionEnd",function(){setTimeout(function(){o.height(o.height()+1)},50)},!1);var l,f,h=!1,a=0,c=0;t.addEventListener("touchstart",function(t){h||(e.get(0).init(),n=e.height(),h=!0),l=t.touches[0].pageY,f=$(this).scrollTop()},!0),t.addEventListener("touchmove",function(t){var e=.35*(t.touches[0].pageY-l);i.isRefreshing||($(this).scrollTop()<=0?e>0&&0==c&&(a=$(this).scrollTop()+e,s($(this).scrollTop()+e,0),t.preventDefault()):l=t.touches[0].pageY)},!0),this.isRefreshing=!1,t.addEventListener("touchend",function(){i.isRefreshing||(a-$(t).scrollTop()>=n?(a=n,c=a,s(n,200),e.get(0).fireRefresh(),isRefreshing=!0,e.get(0).className="fox-refresher-status-loading"):i.refreshComplete())},!0),this.refreshComplete=function(){this.isRefreshing=!1,e.get(0).className="fox-refresher-status-up",s(0,200),a=0,c=0}}}fox("fox-content",{lifecycle:{created:function(){var t=$("fox-refresher",this);this._FoxContent=new FoxContent(this),t.size()>0&&(pulltorefresh=this._FoxContent.setupPulltorefresh(t));var e=$("fox-infinite-scroll",this);e.size()>0&&this._FoxContent.setupInfiniteScroll(e)},inserted:function(){}},methods:{_refreshComplete:function(){this._FoxContent.refreshComplete&&this._FoxContent.refreshComplete()}}});</script></fox-element><fox-element name=fox-icon attributes=icon><script>!function(i){function s(){if(this.icon){var i=this.icon.split("-");i.length>1&&(this.iconFamily=i[0]),this.classList.add(this.iconFamily),this.classList.add(this.icon)}}var t=i.fox;t("fox-icon",{lifecycle:{created:function(){},inserted:function(){s.call(this)},iconChanged:function(i){this.iconFamily&&this.classList.remove(this.iconFamily),i&&this.classList.remove(i),s.call(this)}}})}(this);</script></fox-element><fox-element name=fox-tabbar><script>!function(e){function t(){var e=this.querySelector(".active");e&&e.classList.remove("active")}function i(e){var t,i=e.querySelector("label");return i&&(t=i.textContent),t}var a=e.fox;a("fox-tabbar",{lifecycle:{created:function(){this.classList.add("bar"),this.classList.add("bottom"),!a.query(this,"label").length&&this.classList.add("no-label");var e=a.queryChildren(this,"*"),s=this;e.forEach(function(l){l.addEventListener("click",function(){t.call(s),this.classList.add("active"),a.fireEvent(s,"selected",{detail:{index:e.indexOf(this),label:i(this)}})},!1)})}},methods:{select:function(e){var s=a.queryChildren(this,"*"),l=this;if(t.call(this),"string"==typeof e)s.forEach(function(t,s){var c=i(t);c&&c==e&&(t.classList.add("active"),a.fireEvent(l,"selected",{detail:{index:s,label:c}}))});else{var c=s[e%s.length];c&&c.classList.add("active");var n=i(c);a.fireEvent(this,"selected",{detail:{index:e%s.length,label:n}})}}}})}(this);</script></fox-element><fox-element name=fox-page attributes=transition><script>!function(i){function t(i,t,a){var d=this.transition||"fade",n=a?"backward":"forward";if("display"===this.transition)return void("show"===i?(e(this),this.classList.remove(c[n].display.hide),o.call(this,"aftershow")):"hide"===i&&(this.classList.add(c[n].display.hide),o.call(this,"afterhide")));t=t===!1?!1:!0,this.classList.remove("transition");var h=c[n]||c.forward;if(h[d]||(h[d]=c.forward[d]),!h||!h[d])throw new Error("No transitions for direction "+n);var l=h[d][i],r=h[d].init,f=this;t?("show"===i&&(s(this),this.classList.add(r)),setTimeout(function(){s(f),f.classList.add("transition"),f.classList.add(l)},60)):(s(this),this.classList.add(l)),"show"===i&&e(this)}function s(i){var t=i.classList,s=h.toArray(t);s.forEach(function(i){0===i.indexOf("fx-")&&t.remove(i)})}function e(i){i.classList.remove(l)}function a(){this.removeEventListener("transitionend",a,!1),"show"!==this.action&&(this.classList.add(l),o.call(this,"afterhide"))}function d(){this.removeEventListener("transitionend",d,!1),"hide"!==this.action&&o.call(this,"afterhide")}function n(){var i=this.querySelector(".page-loading-wrapper"),t=this.querySelector("fox-page-content");if(t&&!i){i=document.createElement("div"),i.className="page-loading-wrapper";var s=document.createElement("fox-icon");s.className="animate-spin",s.icon="icon-spin5",i.appendChild(s),t.appendChild(i)}}function o(i){h.fireEvent(this,i,{detail:this})}var h=i.fox,l="transition-out",r="fox-page-loading",c={forward:{fade:{init:"fx-fade-out",show:"fx-fade-in",hide:"fx-fade-out"},hslide:{init:"fx-slide-right",show:"fx-slide-center",hide:"fx-slide-left"},vslide:{init:"fx-slide-down",show:"fx-slide-middle",hide:"fx-slide-down"},display:{hide:"fx-display-hide"}},backward:{hslide:{init:"fx-slide-left",show:"fx-slide-center",hide:"fx-slide-right"},vslide:{init:"fx-slide-down",show:"fx-slide-middle",hide:"fx-slide-down"},display:{hide:"fx-display-hide"}}};h("fox-page",{lifecycle:{created:function(){this.classList.toggle(r,this.loading),this.loading&&n.call(this)},attributeChanged:function(){this.classList.toggle(r,this.loading),this.loading&&n.call(this)}},methods:{show:function(i,s){this.action="show",o.call(this,"beforeshow"),t.apply(this,["show",i,s]),i?this.addEventListener("transitionend",d,!1):o.call(this,"aftershow")},hide:function(i,s){this.action="hide",o.call(this,"beforehide"),i=i===!1?!1:!0,i?this.addEventListener("transitionend",a,!1):this.classList.add(l),t.apply(this,["hide",i,s])}},accessors:{loading:{attribute:{"boolean":!0}}}})}(this);</script></fox-element><fox-element name=fox-model attributes="mode field"><script>function fireChange(t,a){fox.fireEvent(this,"data-change",{detail:{oldVal:t,newVal:a}})}fox("fox-model",{mode:"replace",lifecycle:{created:function(){this._old=null}},methods:{datasourceFilter:function(t){return this._old=this.data,t&&this.field&&this.field.split(".").forEach(function(a){t=t[a]}),t},datasourceChanged:function(t){"array"===$.type(t)&&(this._old&&"replace"!==this.mode?"array"===$.type(this._old)&&("append"===this.mode?this.data=this._old.concat(t):"prepend"===this.mode&&(this.data=t.concat(this._old))):this.data=t),fireChange.apply(this,[this._old,this.data])}}});</script></fox-element><fox-element name=fox-toolbar attributes=title><script>!function(t){function e(t,e){if(t){var i=document.createElement("h1");return i.innerHTML=t,e&&(i.className=e),i}}var i=t.fox;i("fox-toolbar",{lifecycle:{created:function(){this.classList.add("bar"),this.stacks=[],this.title&&this.appendChild(e(this.title))},titleChanged:function(t,i){var s=this.querySelector("h1");s?this.querySelector("h1").innerHTML=i:this.appendChild(e(this.title))}},methods:{push:function(t){this.stacks.push(t);var i=this.querySelector("h1.next");i?i.innerHTML=t.title:(i=e(t.title,"next"),this.appendChild(i)),this.querySelector("h1.out").remove(),this.querySelector("h1.prev").classList.add("out"),i.classList.remove("next")},pop:function(){if(this.stacks.length){{var t=this.stacks.pop();this.querySelector("h1.prev:not(.out)")}nextHeader?nextHeader.innerHTML=t.title:(nextHeader=e(t.title,"next"),this.appendChild(nextHeader)),this.querySelector("h1.next").remove()}}}})}(this);</script></fox-element><fox-element name=fox-json attributes=json><script>function fireChange(t,a){fox.fireEvent(this,"data-change",{detail:{oldVal:t,newVal:a}})}fox("fox-json",{lifecycle:{created:function(){this.data=this.getValue(),fireChange.apply(this,[null,this.data])},jsonChanged:function(t){t=this.data,this.data=this.getValue(),fireChange.apply(this,[t,this.data])}},methods:{getValue:function(){return JSON.parse(this.json)},setValue:function(t){t&&(this.json=JSON.stringify(t))}}});</script></fox-element><fox-element name=fox-ajax attributes="url dataType params response method jsonp headers contentType"><script>fox("fox-ajax",{url:"",dataType:"",auto:!1,params:"",response:null,method:"",jsonp:"",headers:null,contentType:"application/x-www-form-urlencoded",lifecycle:{created:function(){!this.method&&(this.method="GET"),!this.jsonp&&(this.jsonp="callback"),!this.contentType&&(this.contentType="application/x-www-form-urlencoded"),this.autoGo()},urlChanged:function(){this.autoGo()},paramsChanged:function(){this.autoGo()}},accessors:{auto:{attribute:{"boolean":!0}}},methods:{autoGo:function(){this.hasAttribute("auto")&&this.go()},go:function(){var t={type:this.method,url:this.url,dataType:this.dataType,contentType:this.contentType,success:function(t,a,o){var s=e.response;e.data=t,e.response=JSON.stringify(t),fox.fireEvent(e,"data-change",{detail:{oldVal:s,newVal:t}}),fox.fireEvent(e,"success",{detail:{data:t,status:a,xhr:o}})},error:function(t,a,o){fox.fireEvent(e,"error",{detail:{errorType:a,error:o,xhr:t}})},complete:function(){fox.fireEvent(e,"complete")}},e=this;this.params&&(t.data=JSON.parse(this.params)),this.headers&&(t.headers=JSON.parse(this.headers)),$.ajax(t)}}});</script></fox-element><style>.fox-sidemenu-content-wrap,fox-sidemenu-content,fox-sidemenu{position:absolute;left:0;top:0;right:0;bottom:0}fox-sidemenu-menu{position:absolute;top:0;bottom:0;background:#fff;z-index:0}fox-sidemenu{overflow:hidden}.fox-sidemenu-content-wrap{overflow:hidden;z-index:2}</style><fox-element name=fox-sidemenu attributes=sidemenuWidth><script>fox("fox-sidemenu",{lifecycle:{created:function(){this.direction=this.direction||"left"}},methods:{toggle:function(e){var t=this.querySelector("fox-sidemenu-content");t.toggle(e)}}});</script></fox-element><fox-element name=fox-sidemenu-menu attributes=direction><script>fox("fox-sidemenu-menu",{lifecycle:{created:function(){this.direction=this.direction||"left"}}});</script></fox-element><fox-element name=fox-sidemenu-content><tpl><div class=fox-sidemenu-content-wrap><content></content></div></tpl><script>function getSidemenuWidth(){var t=this.sidemenuWidth,e=$(this).width(),n=/(\d+)(%?)/.exec(t);return n?""!=n[2]?e*n[1]/100:e:.8*e}function translateDom(t,e,n){t.style.webkitTransitionDuration=t.style.MozTransitionDuration=t.style.msTransitionDuration=t.style.OTransitionDuration=t.style.transitionDuration=n+"ms",t.style.webkitTransform="translate("+e+"px,0)translateZ(0)",t.style.msTransform=t.style.MozTransform=t.style.OTransform="translateX("+e+"px)"}function translate(t,e){t>=0&&(sidemenus.left&&(translateDom(sidemenus.left,.3*(t-width),e),sidemenus.left.style.zIndex=1),sidemenus.right&&(sidemenus.right.style.zIndex=0)),0>=t&&(sidemenus.left&&(sidemenus.left.style.zIndex=0),sidemenus.right&&(translateDom(sidemenus.right,.3*(t+width),e),sidemenus.right.style.zIndex=1)),translateX=t,translateDom(elWrap,t,e)}function buildMenus(t){for(var e={},n=this.parentElement.querySelectorAll("fox-sidemenu-menu"),i=0;i<n.length;i++){n[i].style.width=t+"px";var s=n[i].direction;"left"==s?(e.left=n[i],n[i].style.left="0"):"right"==s&&(e.right=n[i],n[i].style.right="0")}return e}var elWrap,translateX=0,sidemenus,width;fox("fox-sidemenu-content",{lifecycle:{created:function(){this.direction=this.direction||"",this.sidemenuWidth=this.parentNode.getAttribute("sidemenuwidth")||"80%"},inserted:function(){width=getSidemenuWidth.call(this),sidemenus=buildMenus.call(this,width),sidemenus.left&&(this.direction+="left|"),sidemenus.right&&(this.direction+="right|"),elWrap=this.querySelector(".fox-sidemenu-content-wrap");var t,e,n,i,s,a=this.direction;elWrap.addEventListener("click",function(t){0!=translateX&&(translate(0,200),t.stopPropagation())},!0),elWrap.addEventListener("touchstart",function(a){s=!1,i=translateX,t=a.touches[0].pageX,e=a.touches[0].pageY,n=+new Date},!0),elWrap.addEventListener("touchmove",function(n){if(!(Math.abs(n.touches[0].pageX-t)<Math.abs(n.touches[0].pageY-e))){s=!0;var r=i+n.touches[0].pageX-t;-1!=a.indexOf("left")&&r>=0&&width>=r&&translate(r,0),-1!=a.indexOf("right")&&0>=r&&r>=-width&&translate(r,0),n.preventDefault()}},!0),elWrap.addEventListener("touchend",function(e){if(s){var r=e.changedTouches[0].pageX-t,l=i+r;+new Date-n<200&&Math.abs(r)>50?(-1!=a.indexOf("left")&&l>0&&(r>0?translate(width,200):translate(0,200)),-1!=a.indexOf("right")&&0>l&&(0>r?translate(-width,200):translate(0,200))):(-1!=a.indexOf("left")&&l>0&&(l>width/2?translate(width,200):translate(0,200)),-1!=a.indexOf("right")&&0>l&&(-width/2>l?translate(-width,200):translate(0,200)))}},!0)}},methods:{toggleLeft:function(){},toggle:function(t){"left"==t?0==translateX?translate(width,200):translate(0,200):"right"==t&&(0==translateX?translate(-width,200):translate(0,200))}}});</script></fox-element><fox-element name=fox-page-content><script>!function(n){var o=n.fox;o("fox-page-content")}(this);</script></fox-element><fox-element name=fox-template><script>fox("fox-template",{lifecycle:{created:function(){var e=this;setTimeout(function(){rivets.bind(e,e)},0)}},methods:{datasourceChanged:function(){var e=this;setTimeout(function(){e.classList.add("fox-template-renderred")},200)}}});</script></fox-element><style>fox-stars{display:inline-block;position:relative;width:75px;height:23px;color:#aaa;text-align:left;vertical-align:bottom}fox-stars>*{position:absolute;top:0;left:0;overflow:hidden}fox-stars fox-icon{font-size:10px;margin-right:-2px;display:inline-block}fox-stars>:first-child{width:100%}fox-stars>:last-child>:first-child{width:1000px}</style><fox-element name=fox-stars attributes="stars value"><script>function update(){this.lastElementChild&&(this.lastElementChild.style.width=parseFloat(this.value)/10*100+"%")}fox("fox-stars",{lifecycle:{created:function(){this.stars=parseInt(this.stars)||5,this.value=parseFloat(this.value)||0;var e=document.createElement("div"),t=document.createElement("div");t.style.width=this.value/10*100+"%";var a=document.createElement("div");t.appendChild(a);for(var i=0;i<this.stars;i++){var n=document.createElement("fox-icon");n.icon="icon-star",e.appendChild(n);var l=document.createElement("fox-icon");l.icon="icon-star-filled",a.appendChild(l)}this.innerHTML="",this.appendChild(e),this.appendChild(t)},valueChanged:function(){update.call(this)}}});</script></fox-element>