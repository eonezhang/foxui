<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>fox-calendar/src/fox-calendar.html</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/buildData.html">buildData</a></li>
            
                <li><a href="../classes/fox-actionsheet.html">fox-actionsheet</a></li>
            
                <li><a href="../classes/fox-ajax.html">fox-ajax</a></li>
            
                <li><a href="../classes/fox-calendar.html">fox-calendar</a></li>
            
                <li><a href="../classes/fox-content.html">fox-content</a></li>
            
                <li><a href="../classes/fox-css.html">fox-css</a></li>
            
                <li><a href="../classes/fox-dialog.html">fox-dialog</a></li>
            
                <li><a href="../classes/fox-image-lazyload.html">fox-image-lazyload</a></li>
            
                <li><a href="../classes/fox-image-slider.html">fox-image-slider</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/fox-actionsheet.html">fox-actionsheet</a></li>
            
                <li><a href="../modules/fox-ajax.html">fox-ajax</a></li>
            
                <li><a href="../modules/fox-calendar.html">fox-calendar</a></li>
            
                <li><a href="../modules/fox-content.html">fox-content</a></li>
            
                <li><a href="../modules/fox-dialog.html">fox-dialog</a></li>
            
                <li><a href="../modules/fox-icon.html">fox-icon</a></li>
            
                <li><a href="../modules/fox-image-lazyload.html">fox-image-lazyload</a></li>
            
                <li><a href="../modules/fox-image-slider.html">fox-image-slider</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: fox-calendar/src/fox-calendar.html</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&lt;link rel=&quot;import&quot; href=&quot;../../fox-icon/dist/fox-icon.html&quot;/&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;css/fox-calendar.css&quot;&gt;
&lt;fox-element name=&quot;fox-calendar&quot; attributes=&quot;format input hasControl now display&quot;&gt;

	&lt;tpl&gt;
		&lt;div class=&quot;fox-calendar-detail&quot; id=&quot;fox-calendar-container&quot;&gt;
			&lt;div class=&quot;fox-calendar-toolbar&quot; id=&quot;fox-calendar-toolbar&quot;&gt;
				&lt;button class=&quot;fox-calendar-cancel&quot; id=&quot;fox-calendar-cancel&quot;&gt;
					取消
				&lt;/button&gt;
				&lt;button class=&quot;fox-calendar-set&quot; id=&quot;fox-calendar-set&quot;&gt;
					选取
				&lt;/button&gt;
			&lt;/div&gt;
			&lt;div class=&quot;fox-calendar-selector&quot;&gt;
				&lt;div class=&quot;fox-calendar-selector-left&quot;&gt;
					&lt;fox-icon id=&quot;btn_prev_month&quot; icon=&quot;icon-left-nav&quot;&gt;&lt;/fox-icon&gt;
					&lt;label&gt;{month}月&lt;/label&gt;
					&lt;fox-icon id=&quot;btn_next_month&quot; icon=&quot;icon-right-nav&quot;&gt;&lt;/fox-icon&gt;
				&lt;/div&gt;
				&lt;div class=&quot;fox-calendar-selector-right&quot;&gt;
					&lt;fox-icon id=&quot;btn_prev_year&quot; icon=&quot;icon-left-nav&quot;&gt;&lt;/fox-icon&gt;
					&lt;label&gt;{year}年&lt;/label&gt;
					&lt;fox-icon id=&quot;btn_next_year&quot; icon=&quot;icon-right-nav&quot;&gt;&lt;/fox-icon&gt;
				&lt;/div&gt;
			&lt;/div&gt;
			&lt;div class=&quot;fox-calendar-week-header&quot;&gt;
				&lt;div class=&quot;fox-calendar-week-item&quot;&gt;
					日
				&lt;/div&gt;
				&lt;div class=&quot;fox-calendar-week-item&quot;&gt;
					一
				&lt;/div&gt;
				&lt;div class=&quot;fox-calendar-week-item&quot;&gt;
					二
				&lt;/div&gt;
				&lt;div class=&quot;fox-calendar-week-item&quot;&gt;
					三
				&lt;/div&gt;
				&lt;div class=&quot;fox-calendar-week-item&quot;&gt;
					四
				&lt;/div&gt;
				&lt;div class=&quot;fox-calendar-week-item&quot;&gt;
					五
				&lt;/div&gt;
				&lt;div class=&quot;fox-calendar-week-item&quot;&gt;
					六
				&lt;/div&gt;
			&lt;/div&gt;
			&lt;div class=&quot;fox-calendar-month-detail&quot;&gt;
				&lt;div class=&quot;fox-calendar-row&quot; rv-each-row=&quot;list&quot;&gt;
					&lt;div class=&quot;fox-calendar-col&quot; rv-data-val=&quot;col.val&quot; rv-class=&quot;col.type&quot; rv-each-col=&quot;row&quot;&gt;
						&lt;span class=&quot;fox-calendar-col-inner&quot;&gt; {col.val} &lt;/span&gt;

					&lt;/div&gt;
				&lt;/div&gt;
			&lt;/div&gt;
		&lt;/div&gt;
	&lt;/tpl&gt;
	&lt;script src=&quot;lib/moment.min.js&quot;&gt;&lt;/script&gt;
	&lt;script&gt;
		/**
			* This is the fox-calendar constructor function 
			* @class fox-calendar
			* @module fox-calendar
			* @constructor
			* @param {Object} el the current calendar 
		*/
		function Calendar(el) {

			/**
				* Assists in getting the number of days in the current month
				* @method daysInMonth
				* @static
				* @param {Integer} month the current month 
				* @param {Integer} year the current year
				* @return {Integer} the number of days in the month of the year
			*/
			function daysInMonth(month, year) {
				return new Date(year, month, 0).getDate();
			}

			/**
				* Assists in getting the number of weeks in the current month
				* @method weekInMonth
				* @static
				* @param {Integer} month the current month 
				* @param {Integer} year the current year
				* @return {Integer} the number of weeks in the month of the year
			*/
			function weekInMonth(month, year) {
				return new Date(year, month - 1, 1).getDay();
			}
			
			var minDate,maxDate;

			var self = this;
			
			/**
				* Assists in knowing if the given date is within the range of the month
				* @method isInRange
				* @static
				* @param {Integer} date the current date 
				* @return {Boolean} returns true if the date is within range, false elsewise
			*/
			function isInRange(date){
				if(minDate &amp;&amp; date.getTime()&lt;minDate.getTime()){
					return false;
				}else if(maxDate &amp;&amp; date.getTime()&gt;maxDate.getTime()){
					return false;
				}
				return true;
			}
			
			/**
				* Assists in enabling/disabling the neighbor months or years
				* @method updateSelect
				* @static
				* @param {Integer} month the current month 
				* @param {Integer} year the current year
			*/
			function updateSelect(year,month){
				if(minDate &amp;&amp; year-1&lt;minDate.getFullYear()){
					$btnPrevYear.addClass(&quot;disable&quot;);
				}else{
					$btnPrevYear.removeClass(&quot;disable&quot;);
				}
				
				if(minDate &amp;&amp; month-2&lt;minDate.getMonth()){
					$btnPrevMonth.addClass(&quot;disable&quot;);
				}else{
					$btnPrevMonth.removeClass(&quot;disable&quot;);
				}
				
				if(maxDate &amp;&amp; year+1&gt;maxDate.getFullYear()){
					$btnNextYear.addClass(&quot;disable&quot;);
				}else{
					$btnNextYear.removeClass(&quot;disable&quot;);
				}
				
				if(maxDate &amp;&amp; month&gt;maxDate.getMonth()){
					$btnNextMonth.addClass(&quot;disable&quot;);
				}else{
					$btnNextMonth.removeClass(&quot;disable&quot;);
				}
				
			}


			var $btnNextMonth = $(el.$[&#x27;btn_next_month&#x27;]).bind(&#x27;click&#x27;, function() {
				if(!$(this).hasClass(&quot;disable&quot;)){
					self.createNextMonth();
				}
			});

			var $btnPrevMonth = $(el.$[&#x27;btn_prev_month&#x27;]).bind(&#x27;click&#x27;, function() {
				if(!$(this).hasClass(&quot;disable&quot;)){
					self.createPrevMonth();
				}
			});

			var $btnPrevYear = $(el.$[&#x27;btn_prev_year&#x27;]).bind(&#x27;click&#x27;, function() {
				if(!$(this).hasClass(&quot;disable&quot;)){
					self.createPrevYear();
				}
			});

			var $btnNextYear = $(el.$[&#x27;btn_next_year&#x27;]).bind(&#x27;click&#x27;, function() {
				if(!$(this).hasClass(&quot;disable&quot;)){
					self.createNextYear();
				}
			});

			var _year, _month;

			var lastCol, lastDate;

			$(el).delegate(&quot;.fox-calendar-col.normal&quot;, &quot;click&quot;, function() {
				$(el.$[&#x27;fox-calendar-set&#x27;]).removeAttr(&quot;disabled&quot;);
				$(&quot;.fox-calendar-col.active&quot;,el).removeClass(&quot;active&quot;);
				$(this).addClass(&quot;active&quot;);
				lastDate = new Date(_year,_month-1,$(this).data(&quot;val&quot;));
				if(!$(el.$[&#x27;fox-calendar-toolbar&#x27;]).hasClass(&quot;active&quot;)){
					$(el.$[&#x27;fox-calendar-set&#x27;]).click();
				}
			});

			$(el).delegate(&quot;.fox-calendar-col.prev&quot;, &quot;click&quot;, function() {
				$btnPrevMonth.click();
			});
			$(el).delegate(&quot;.fox-calendar-col.next&quot;, &quot;click&quot;, function() {
				
				$btnNextMonth.click();
			});

			$(el.$[&#x27;fox-calendar-cancel&#x27;]).bind(&quot;click&quot;, function() {
				el.close();
			});

			$(el.$[&#x27;fox-calendar-set&#x27;]).bind(&quot;click&quot;, function() {
				if(lastDate){
					el.close();
					el.fireSelectEvent(lastDate);
				}
			});
			
			this.setLastDate = function(date){
				lastDate = date;
			};

			this.create = function(year, month) {
				updateSelect(year,month);
				$(&quot;.fox-calendar-col.active&quot;,el).removeClass(&quot;active&quot;);
				_year = year;
				_month = month;
				var list = [];
				list.push([]);

				for (var i = 0, l = weekInMonth(month, year), j = daysInMonth(month - 1, year); i &lt; l; i++) {
					list[0].push({
						&quot;val&quot; : j - (l - i - 1),
						&quot;type&quot; : &quot;prev&quot;
					});
				}

				for (var i = 1; i &lt;= daysInMonth(month, year); i++) {
					var active = &quot;&quot;,type = &quot;normal&quot;;
					if (lastDate &amp;&amp; lastDate.getFullYear() == year &amp;&amp; lastDate.getMonth()+1 == month &amp;&amp; lastDate.getDate() == i) {
						active = &quot;active&quot;;
					}
					
					if(!isInRange(new Date(year,month-1,i))){
						type = &quot;disable&quot;;
					}
					
					var arr = list[list.length - 1];
					if (arr.length &gt; 6) {
						arr = [];
						list.push(arr);
					}
					arr.push({
						&quot;val&quot; : i,
						&quot;type&quot; : type+&quot; &quot; + active
					});
				}

				var count = 0;

				list.forEach(function(arr) {
					count += arr.length;
				});

				for (var i = count, j = 1; i &lt; 42; i++, j++) {
					var arr = list[list.length - 1];
					if (arr.length &gt; 6) {
						arr = [];
						list.push(arr);
					}
					arr.push({
						&quot;val&quot; : j,
						&quot;type&quot; : &quot;next&quot;
					});
				}
				el.year = year;
				el.month = month;
				el.list = list;
			};
			
			
			/**
				* This method is called to update the calendar
				* @method update
				* @chainable
			*/
			this.update = function(){
				this.create(_year,_month);
			};
			
			/**
				* This method is called to compare the current date with the date passed
				* into the method and set the minimum as current
				* @method setMinDate
				* @param {Integer} date the current selected date
				* @chainable
			*/
			this.setMinDate = function(date){
				
				minDate = date;
				if(date &amp;&amp; (date.getMonth()+1&gt;_month||date.getFullYear()&gt;_year)){
					this.create(date.getFullYear(),date.getMonth()+1);
				}else{
					this.update();
				}
			};

			/**
				* This method is called to compare the current date with the date passed
				* into the method and set the maximum as current
				* @method setMaxDate
				* @param {Integer} date the current selected date
				* @chainable
			*/
			this.setMaxDate = function(date){
				maxDate = date;
				if(date &amp;&amp; (date.getMonth()+1&lt;_month||date.getFullYear()&lt;_year)){
					this.create(date.getFullYear(),date.getMonth()+1);
				}else{
					this.update();
				}
			};
			
			/**
				* This method is called to create the next month on the calendar
				* @method createNextMonth
				* @chainable
			*/
			this.createNextMonth = function() {
				_month++;
				if (_month &gt; 12) {
					_month = 1;
					_year++;
				}
				this.create(_year, _month);
			};

			/**
				* This method is called to create the previous month on the calendar
				* @method createPrevMonth
				* @chainable
			*/
			this.createPrevMonth = function() {
				_month--;
				if (_month == 0) {
					_month = 12;
					_year--;
				}
				this.create(_year, _month);
			};

			/**
				* This method is called to create the next year on the calendar
				* @method createNextYear
				* @chainable
			*/
			this.createNextYear = function() {
				_year++;
				this.create(_year, _month);
			};

			/**
				* This method is called to create the prev year on the calendar
				* @method createPrevYear
				* @chainable
			*/
			this.createPrevYear = function() {
				_year--;
				this.create(_year, _month);
			};
			
			/**
				* This method is called to set the current Calendar as active 
				* if the method has control
				* @method hasControl
				* @param {Boolean} hasControl true if the method has control, false elsewise
				* @chainable
			*/
			this.setControl = function(hasControl){
				$(el.$[&#x27;fox-calendar-toolbar&#x27;]).addClass(hasControl===&quot;true&quot;?&quot;active&quot;:&quot;&quot;);
			};

		}

		/**
    		* This is the calendar component that the users are able to select dates on the calendar  
    		* @class fox-calendar
    		* @static
    	*/
		fox(&quot;fox-calendar&quot;, {
			/**
				* Defines a lifecycle of the calendar
				* @attribute lifecycle
				* @type Object
			*/
			lifecycle : {
				created : function() {
					var self = this;
					this.format = this.format || &quot;YYYY-MM-DD&quot;;
					this.now = this.now ||  moment().format(this.format);
					this.hasControl = this.hasControl || &quot;false&quot;;
					this.display = this.display || &quot;bottom&quot;;
					this.calendar = new Calendar(this);
					$(function(){
						self.bind();
					});
					
					this.init();
				}
				
			},

			/**
				* Define all methods of the calendar
				* @attribute methods
				* @type Object
			*/
			methods : {
				&quot;bind&quot;:function(){
					var self = this;
					var $input = $(document.getElementById(this.input)).bind(&quot;click&quot;,function(){
						self.show();
					}).attr(&quot;readonly&quot;,&quot;readonly&quot;);
					$(this).bind(&quot;select&quot;,function(e){
						var val = &quot;&quot;;
						if(typeof self.format == &quot;string&quot;){
							val = moment(e.detail).format(self.format);
						}else if(typeof self.format == &quot;function&quot;){
							val = param.format(e.detail);
						}
						$input.val(val);
					});
					
				},
				&quot;init&quot;:function(){
					var date = this.getDate();
					$(this).addClass(this.display);
					// this.calendar.setLastDate(date);
					this.calendar.setControl(this.hasControl);
					this.calendar.create(date.getFullYear(), date.getMonth()+1);
					
				},
				&quot;getDate&quot;:function(){
					return moment(this.now,this.format).toDate();
				},
				&quot;show&quot; : function() {
					var self = this;
					setTimeout(function() {
						$(self).addClass(&quot;active&quot;);
					}, 0);

				},
				&quot;close&quot; : function() {
					var self = this;
					$(this).removeClass(&quot;active&quot;);
				},
				&quot;setControl&quot;:function(hasControl){
					this.calendar.setControl(hasControl);
				},
				&quot;setMinDate&quot;:function(date){
					this.calendar.setMinDate(date);
				},
				&quot;setMaxDate&quot;:function(date){
					this.calendar.setMaxDate(date);
				},
				&quot;fireSelectEvent&quot;:function(date){
					xtag.fireEvent(this, &#x27;select&#x27;, {
						&#x27;detail&#x27; : date
					});
				}
			}
		});

		

	&lt;/script&gt;
&lt;/fox-element&gt;
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
